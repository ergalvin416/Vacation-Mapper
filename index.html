<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Vacation Mapper V41</title>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC78EKBgSd2UsLSPUTGO1A-MF78BU20aLg&libraries=places"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <style>
        :root { --bg:#1e1e24; --accent:#4a90e2; --text:#eee; }
        body { margin:0; display:flex; height:100vh; font-family:-apple-system,sans-serif; background:#121212; color:var(--text); overflow:hidden; }
        #container { display:flex; width:100%; height:100%; flex-direction: row; }
        #sidebar { width:350px; background:var(--bg); border-right:1px solid #333; display:flex; flex-direction:column; overflow-y:auto; z-index: 10; }
        #map { flex:1; position: relative; }
        @media (max-width: 768px) {
            #container { flex-direction: column; }
            #map { height: 65vh; width: 100%; order: 1; }
            #sidebar { height: 35vh; width: 100%; order: 2; border-right: none; border-top: 2px solid #333; }
        }
        .section { padding:15px; border-bottom:1px solid #333; }
        .vacation-item { padding:12px; background:#2a2a32; margin-bottom:8px; border-radius:8px; cursor:pointer; display:flex; justify-content:space-between; align-items: center; border-left: 6px solid transparent; }
        .active-trip { border-left: 6px solid var(--accent); background:#3a3a45; }
        .note-preview { font-size: 11px; color: #aaa; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 220px; }
        input { width:100%; margin-bottom:10px; background:#121212; color:white; border:1px solid #444; padding:12px; border-radius:6px; box-sizing:border-box; font-size: 16px; }
        button.primary { width:100%; padding:12px; background:var(--accent); border:none; color:white; font-weight:bold; cursor:pointer; border-radius:6px; }
        .gps-btn { position: absolute; bottom: 20px; right: 20px; background: white; width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 15px rgba(0,0,0,0.4); z-index: 5; cursor: pointer; font-size: 20px; }
    </style>
</head>
<body>

<div id="container">
    <div id="sidebar">
        <div class="section">
            <h3 style="margin-top:0">üåç SHARED VACATIONS</h3>
            <input id="tripName" placeholder="NEW TRIP NAME..." />
            <button class="primary" onclick="addTrip()">CREATE FOLDER</button>
            <div id="tripList" style="margin-top:10px"></div>
        </div>
        <div class="section" id="place-details">
            <h4 id="activeTripTitle" style="color:var(--accent); margin-top:0;">SAVED PINS</h4>
            <div id="groupedList"></div>
        </div>
    </div>
    <div id="map"><div class="gps-btn" onclick="locateMe()">üìç</div></div>
</div>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyAlflCNqAaVmui0ipNCCWs3XNsvjprlFYA",
    authDomain: "vacation-mapper-1e723.firebaseapp.com",
    databaseURL: "https://vacation-mapper-1e723-default-rtdb.firebaseio.com",
    projectId: "vacation-mapper-1e723",
    storageBucket: "vacation-mapper-1e723.firebasestorage.app",
    messagingSenderId: "773407322730",
    appId: "1:773407322730:web:9b27eb7ee5c3ebac2cd013"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let map, infoWindow, trips = {}, activeTrip = null, markers = [];

function initMap() {
    map = new google.maps.Map(document.getElementById('map'), { center:{lat:39.8,lng:-98.5}, zoom:4, mapTypeId:'hybrid' });
    infoWindow = new google.maps.InfoWindow();
    db.ref('trips').on('value', (snapshot) => {
        trips = snapshot.val() || {};
        renderTrips();
        if (activeTrip) loadTrip(activeTrip);
    });
}

function addTrip() {
    const n = document.getElementById('tripName').value.trim();
    if (!n) return;
    trips[n] = { created: Date.now() };
    db.ref('trips').set(trips).then(() => { document.getElementById('tripName').value = ''; });
}

function renderTrips() {
    const el = document.getElementById('tripList'); el.innerHTML='';
    Object.keys(trips).forEach(n => {
        const div = document.createElement('div');
        div.className = `vacation-item ${activeTrip === n ? 'active-trip' : ''}`;
        div.innerHTML = `<span>${n.toUpperCase()}</span>`;
        div.onclick = () => loadTrip(n);
        el.appendChild(div);
    });
}

function loadTrip(name) {
    activeTrip = name;
    document.getElementById('activeTripTitle').innerText = name.toUpperCase();
    renderTrips();
}

function locateMe() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
            map.setCenter({ lat: pos.coords.latitude, lng: pos.coords.longitude });
            map.setZoom(16);
        });
    }
}

window.onload = initMap;
</script>
</body>
</html>
